/*
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Nextflow config file for MPGI local equipment
- Profile for running on local MPGI servers or workstations
- Sets resource limits and Apptainer options for local execution
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
*/

// -----------------------------
// Process resource limits
// -----------------------------
process {
    errorStrategy = { task.attempt < 3 ? 'retry' : 'ignore' }
    maxRetries = 2
    resourceLimits = [
        cpus: 32,           // Max CPUs per process (test)
        memory: '100.GB',   // Max memory per process (test)
        time: '120.h'        // Max time per process (test)
    ]
}

// -----------------------------
// Pipeline parameter overrides
// -----------------------------
params {
    publish_dir_mode           = 'link'
    max_memory                 = '100G'
    max_cpus                   = 32
    max_time                   = '168h'
}

apptainer {
    enabled    = true                 // Enable Apptainer for containerized execution
    autoMounts = true                 // Automatically mount common host paths
    runOptions = '--writable-tmpfs'   // Use writable tmpfs for container
    cacheDir   = "/data/Platform/simages/" // Set custom cache directory for images
    pullTimeout = '1h'
}
